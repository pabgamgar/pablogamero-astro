---
import MainLayout from "@/layouts/MainLayout.astro";
import Home from "@/sections/home.astro";
import About from "@/sections/about.astro";
import Portfolio from "@/sections/portfolio.astro";
import Contact from "@/sections/contact.astro";
import "@/styles/globals.css";

let activeSection = "Home";

const aboutNav = [
  {
    title: "😄 Bio",
    href: "#bio",
  },
  {
    title: "🌟 Ideas",
    href: "#ideas",
  },
  {
    title: "🛠️ Tools",
    href: "#tools",
  },
] as const;

const portfolioNav = [
  {
    title: "🚀 Projects",
    href: "#projects",
  },
  {
    title: "🧩 Skills",
    href: "#skills",
  },
  {
    title: "📆 Timeline",
    href: "#timeline",
  },
  // {
  //   title: "📝 Blog",
  //   href: "#skills",
  // },
  // {
  //   title: "📚 Books",
  //   href: "#tools",
  // },
] as const;
---

<script>
  let activeIndex = 0;

  let articles = document.querySelectorAll(
    "article"
  ) as NodeListOf<HTMLElement>;

  let buttons = document.querySelectorAll(
    "button.nav"
  ) as NodeListOf<HTMLButtonElement>;

  for (var i = 0, size = buttons.length; i < size; i++) {
    buttons[i].addEventListener(
      "click",
      function (i: number) {
        handleClick(i);
      }.bind(null, i)
    );
  }

  let cta = document.getElementById("work-CTA") as HTMLElement;

  cta.addEventListener("click", function () {
    handleClick(3);
  });

  function handleClick(index: number) {
    // Bump the active index
    const nextIndex = index;

    articles[activeIndex].dataset.status = "inactive";
    articles[nextIndex].dataset.status = "active";

    buttons[activeIndex].dataset.status = "inactive";
    buttons[nextIndex].dataset.status = "active";

    activeIndex = nextIndex;
    console.log(activeIndex);
  }
</script>

<MainLayout title="" desc="" lang="en">
  <header
    class="absolute top-4 left-1/2 -translate-x-1/2 p-2 h-fit z-10 rounded-full flex gap-2 w-[460px] max-[480px]:w-[95%] max-[480px]:flex-wrap max-[480px]:rounded-lg justify-between max-[480px]:justify-around"
  >
    <button class="nav" data-index="0" data-status="active">🏠 Home</button>
    <button class="nav" data-index="1" data-status="inactive">👨🏻‍💻 About</button>
    <button class="nav" data-index="2" data-status="inactive"
      >📑 Portfolio</button
    >
    <button class="nav" data-index="3" data-status="inactive">✉️ Contact</button
    >
  </header>
  <article data-index="0" data-status="active">
    <Home />
  </article>
  <article data-index="1" data-status="inactive">
    <div class="container">
      <div
        class="contentheader w-96 absolute top-0 -translate-y-1/2 z-20 rounded-full p-2 flex justify-between shadow-xl"
      >
        {
          aboutNav.map((link) => (
            <a href={link.href} class="transition duration-300">
              {link.title}
            </a>
          ))
        }
      </div>
      <About />
    </div>
  </article>
  <article data-index="2" data-status="inactive">
    <div class="container">
      <div
        class="contentheader w-96 absolute top-0 -translate-y-1/2 z-20 rounded-full p-2 flex justify-between shadow-xl"
      >
        {
          portfolioNav.map((link) => (
            <a href={link.href} class="transition duration-300">
              {link.title}
            </a>
          ))
        }
      </div>
      <Portfolio />
    </div>
  </article>
  <article data-index="3" data-status="inactive">
    <div class="container">
      <Contact />
    </div>
  </article>
</MainLayout>

<style is:global>
  header {
    background: linear-gradient(
      135deg,
      rgba(255, 255, 255, 0.2),
      rgba(255, 255, 255, 0.1)
    );
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
  }

  header > button {
    border-radius: 100px;
    padding-inline: 1rem;
    padding-block: 0.25rem;
  }

  button[data-status="active"] {
    box-shadow: 0px 1px 8px 0 rgba(0, 0, 0, 0.37);
  }

  .contentheader {
    background: linear-gradient(
      135deg,
      rgba(255, 255, 255, 0.2),
      rgba(255, 255, 255, 0.1)
    );
    backdrop-filter: blur(10px);
    width: fit-content;
    gap: 0.5rem;
  }

  .contentheader > a {
    padding-inline: 0.5rem;
    border-radius: 100px;
  }

  .contentheader > a:hover {
    box-shadow: 0px 1px 8px 0 rgba(0, 0, 0, 0.37);
  }

  article {
    height: 100%;
    width: 100%;
    position: absolute;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    left: 0;
    top: 0;
    transition: transform 1s ease-in-out;
    transition-delay: 1s;
    padding: 1rem;
  }

  article[data-status="inactive"] {
    transform: translateX(-100%);
    transition-delay: 0ms;
  }

  .container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    max-width: 1000px;
    width: max(95%, 300px);
    height: 80%;
    position: relative;
  }

  .content {
    max-width: 1000px;
    width: max(95vw, 300px);
    height: 80vh;
    overflow-y: auto;
    background: linear-gradient(
      135deg,
      rgba(255, 255, 255, 0.2),
      rgba(255, 255, 255, 0.1)
    );
    align-self: center;
    border-radius: 16px;
    scroll-behavior: smooth;
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
    padding: 3rem 2rem;
    position: relative;
  }

  .title {
    font-size: 2rem;
    font-weight: 700;
    margin-block: 1rem;
    align-self: self-start;
  }

  @media screen and (max-width: 480px) {
    header > button {
      border-radius: 5px;
      padding-inline: 1rem;
      padding-block: 0.25rem;
    }
  }
</style>
